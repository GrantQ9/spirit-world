import { allTiles } from 'app/content/tiles';

import { SourcePalette, TilePalette } from 'app/types';

export const sourcePalettes: {[key: string]: SourcePalette} = {};
const everything: TilePalette = [[]];
let x = 0, y = 0;
for (let i = 0; i < allTiles.length; i++) {
    const image = allTiles[i]?.frame?.image;
    if (image instanceof HTMLImageElement) {
        const key = image.src.split('public/gfx/')[1];
        sourcePalettes[key] = sourcePalettes[key] || {
            source: allTiles[i].frame,
            tiles: [],
        };
        sourcePalettes[key].tiles.push(i);
    }
    if (!everything[y]) {
        everything[y] = [];
    }
    everything[y][x++] = i;
    if (x >= 16) {
        y++;
        x = 0;
    }
}

const cave: TilePalette = [
    [38,45,45,45,45,45,45,37,38,45,45,45,45,45,45,37],
    [46,74,75,66,67,76,77,47,46,82,83,58,59,84,85,47],
    [46,90,91,68,69,92,93,47,46,98,99,60,61,100,101,47],
    [46,70,71,44,43,62,63,47,46,62,63,57,57,70,71,47],
    [46,72,73,41,42,64,65,47,46,64,65,57,57,72,73,47],
    [46,80,81,58,59,78,79,47,46,86,87,66,67,88,89,47],
    [46,96,97,60,61,94,95,47,46,102,103,68,69,104,105,47],
    [39,48,48,48,48,48,48,40,39,48,48,48,48,48,48,40],
    [36,49,50,51,52,53,54,55,56,1,6,7,8,9,10,0,],
    [2,3,4,5,26,27,28,29,111,106,107,1,1,1,1,1],
];

const overworld: TilePalette = [
    [38,45,45,45,45,45,45,37,38,45,45,45,45,45,45,37],
    [46,219,220,211,212,221,222,47,46,227,228,203,204,229,230,47],
    [46,235,236,213,214,237,238,47,46,243,244,205,206,245,246,47],
    [46,215,216,44,43,207,208,47,46,207,208,57,57,215,216,47],
    [46,217,218,41,42,209,210,47,46,209,210,57,57,217,218,47],
    [46,225,226,203,204,223,224,47,46,231,232,211,212,233,234,47],
    [46,241,242,205,206,239,240,47,46,247,248,213,214,249,250,47],
    [39,48,48,48,48,48,48,40,39,48,48,48,48,48,48,40],
    [11,12,13,14,15,16,17,18,19,20,21,6,7,8,9,10],
    [36, 2,3,4,5,26,27,28,29,111,106,107,30,31,32,0],
    [49,50,51,52,53,54,55,56,1,1,1,33,34,35,0,0],
];

const caveRoom: TilePalette = [
    [74,75,66,67,66,67,66,67,66,67,66,67,66,67,76,77],
    [90,91,68,69,68,69,68,69,68,69,68,69,68,69,92,93],
    [70,71,44,48,48,48,48,48,48,48,48,48,48,43,62,63],
    [72,73,47,36,36,36,36,36,36,36,36,36,36,46,64,65],
    [70,71,47,36,36,36,36,36,36,36,36,36,36,46,62,63],
    [72,73,47,36,36,36,36,36,36,36,36,36,36,46,64,65],
    [70,71,47,36,36,36,36,36,36,36,36,36,36,46,62,63],
    [72,73,47,36,36,36,36,36,36,36,36,36,36,46,64,65],
    [70,71,47,36,36,36,36,36,36,36,36,36,36,46,62,63],
    [72,73,47,36,36,36,36,36,36,36,36,36,36,46,64,65],
    [70,71,47,36,36,36,36,36,36,36,36,36,36,46,62,63],
    [72,73,47,36,36,36,36,36,36,36,36,36,36,46,64,65],
    [70,71,47,36,36,36,36,36,36,36,36,36,36,46,62,63],
    [72,73,41,45,45,45,45,45,45,45,45,45,45,42,64,65],
    [80,81,58,59,58,59,58,59,58,59,58,59,58,59,78,79],
    [96,97,60,61,60,61,60,61,60,61,60,61,60,61,94,95],
];

const town: TilePalette = [
    [388,376,377,378,336,337,338,347,356,357,358,367],
    [389,379,288,381,340,341,342,339,360,361,362,359],
    [390,382,383,384,344,345,346,343,364,365,366,363],
    [0,385,386,387,348,349,350,351,368,369,370,371],
    [0,0,0,0,352,353,354,355,372,373,374,375],
];

const townAndMarketDecoration: TilePalette = [
    [305,306,307,308,309,310,0],
    [311,312,313,314,315,316,0],
    [327,328,329,319,320,321,322],
    [332,333,318,323,324,325,326],
    [334,335,317,330,331,288,0],
];

const houseRoom: TilePalette = [
    [348,349,349,349,349,349,349,349,349,349,349,349,349,349,349,350],
    [348,349,353,353,343,353,343,353,343,353,343,353,353,353,349,350],
    [348,349,0,0,0,0,0,0,0,0,0,0,0,0,349,350],
    [348,349,0,0,0,0,0,0,0,0,0,0,0,0,349,350],
    [348,347,0,0,0,0,0,0,0,0,0,0,0,0,347,350],
    [348,349,0,279,0,0,281,0,0,0,0,0,0,0,349,350],
    [348,349,275,283,276,277,285,278,0,0,0,0,0,0,349,350],
    [348,347,288,280,0,0,282,0,0,0,0,0,0,0,347,350],
    [348,349,393,393,251,252,253,254,255,256,263,264,0,0,349,350],
    [348,349,393,393,261,257,284,258,259,260,267,268,0,0,349,350],
    [348,347,392,392,391,391,271,272,0,0,0,0,0,0,347,350],
    [348,349,392,392,391,391,0,0,0,0,0,0,0,0,349,350],
    [348,349,349,339,349,339,349,349,349,349,339,349,339,349,349,350],
    [352,353,353,353,353,353,353,353,353,353,353,353,353,353,353,354],
];

const clouds: TilePalette= [
    [394, 395, 396, 406, 407, 0, 153, 154, 0],
    [398, 399, 400, 410, 411, 155, 156, 157, 158],
    [402, 403, 404, 408, 409, 159, 160, 161, 162],
    [397, 401, 405, 412, 413, 0, 163, 164, 0],
];

const water: TilePalette = [
    [422, 423, 424, 429, 453, 454, 455, 425, 123, 124, 125, 132],
    [426, 427, 428, 456, 457, 458, 459, 460, 126, 127, 128, 132],
    [430, 431, 432, 0, 461, 462, 463, 0, 129, 130, 131, 0],
    [433, 434, 435, 436, 464, 465, 466, 467, 133, 134, 135, 136],
    [437, 438, 439, 440, 468, 469, 470, 471, 137, 138, 139, 140],
    [0, 441, 442, 0, 0, 472, 473, 0, 0, 141, 142, 0],
    [443, 444, 445, 446, 474, 475, 476, 477, 143, 144, 145, 146],
    [447, 448, 449, 450, 478, 479, 480, 481, 147, 148, 149, 150],
    [0, 451, 452, 0, 0, 482, 483, 0, 0, 151, 152, 0],
];

const trees: TilePalette = [
    [505, 506, 507, 508, 0, 517, 518, 519, 520, 1, 0, 517, 518, 519, 520, 1],
    [509, 510, 511, 512, 521, 522, 523, 524, 525, 526, 521, 522, 523, 524, 525, 526],
    [513, 514, 515, 516, 527, 528, 529, 530, 531, 532, 527, 528, 529, 530, 531, 532],
    [552, 553, 554, 555, 533, 534, 535, 536, 537, 538, 533, 534, 541, 542, 537, 538],
    [556, 557, 558, 559, 0, 0, 539, 540, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 517, 518, 519, 520, 517, 518, 519, 520, 1, 517, 518, 519, 520, 1, 1],
    [521, 522, 523, 524, 543, 544, 523, 524, 525, 549, 522, 523, 524, 525, 526, 1],
    [527, 528, 529, 530, 545, 546, 529, 530, 531, 550, 528, 529, 530, 531, 532, 0],
    [533, 534, 535, 536, 547, 548, 535, 536, 537, 551, 534, 535, 536, 537, 538, 0],
    [0, 0, 539, 540, 0, 0, 539, 540, 0, 0, 0, 539, 540, 0, 0, 0],
];

// Use this to export the current brush as a palette grid.
/**
console.log(editingState.brush.none.tiles.map(t => "\t[" + t.join(", ") + "],").join("\n"));
 */
export const palettes = {
    overworld,
    cave,
    caveRoom,
    water,
    town,
    townAndMarketDecoration,
    houseRoom,
    clouds,
    trees,
    everything,
};

window['palettes'] = palettes;
