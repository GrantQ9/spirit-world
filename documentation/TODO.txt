Test at http://localhost:81/alttp/public/

Known Bugs:
    - Door closing sound plays while in the title screen
        - Maybe just disable playAreaSound in the title scene or only play this sound if the player passes through the door and it closes behind them.
    - Teleporting while grabbing a pot with astral projection can make you face south but still be grabbing the pot
        - Probably stop grabbing with projection when teleporting.
    - Player is rendered behind ceiling when climbing ladders
        - Possible solution: render player on foreground layer when climbing ladders.
    - Enemies hit in the spirit world make noise when taking damage
        - this might be nice to keep for the cocoon boss
        - when players can actively hit enemies in the spirit world we should play a sound. For example, hitting an enemy with a linked bush shouldn't be silent.
    - Clone tool bugs
        - Mana regen is wrong when using clone tools (seems to multiply consumption/regen by number of clones)
    - Held rocks/bushes are invisible while using cloak
    - Piercing projectiles that can push things should be stopped by the first object they push
        or not be able to push additional objects, for example, the charged chakram.
    - Pushing on a solid object sitting on thorny ground shouldn't hurt you:
        -return tileBehaviors and objectBehaviors separately, only damage if tile is solid+damaging.
    - Cliff Edge issues:
        - Would be nice if staff could go across edges.
        - Sometimes bow/chakram get stopped when firing down cliff edges
            - This is because these tiles are not marked low.
            - Marking these tiles as low would allow shooting up them as they don't have actual cliff ledges
            - Marking these tiles as cliff ledges will probably allow jumping down them in some cases which will need to be fixed.
    - Shadow renders behind door tops when jumping down ledges.

Possible issues in the future:
    - Refresh area logic application of special behavior doesn't quite work as intended
        - Objects that change position based on location will get reset on area logic refresh, which might be strange if they had been moved beforehand.
            - Currently this doesn't actually happen anywhere, but it could cause unexpected issues if we add a case that runs into this issue.

Graphics:
    Add slam effects for the staff.
    Sweat animation when pulling on something you cannot move.
    Add Item Get Frame gfx/wukongimportantitem.png 20x28
    Add sparkles to peach loot + hud.
    Add damage effects for hitting enemies?
    Add damage effect for player hurt? (alttp doesn't have anything like this)

Current tasks:
    - Lightning switch to open material world basement in staff tower
        - 3 sentry bots that are off if boss is defeated, must be activated to defeat and get gold ore
        - Can be done in randomizer without defeating boss but all 3 will be active at once
        - Same switch exists in spirit world can let you shortcut to basement in randomizer

    - Stretch goal: allow changing lightning AOE attacks to use a ray instead of a circle if the player is too close to a conductive object.

    - Brainstorm ideas for Sky Palace
        - Lightning switches toggle mechanisms like platforms and wind turbines.
            - Lightning is not required to complete any of the dungeon, but may make sections quicker/easier.
        - Heavy 2x2 blocks that can only be pushed if the player has mitts
        - Big key in a chest that you have to fall to.
        Mechanic: Windstream
            - Pushes player back unless they are using iron boots or holding on to a solid object.
            - Player can push pots to move through wind streams.
            - Player can be pushed across wide pits by equipping cloud boots and entering a wind stream or up to the next floor
            - There may be light objects that players can push into windstreams to move them, perhaps to solve switch puzzles

    - Player ice damage should only freeze ground that has certain properties:
        - shallow and deep water
        - lava
        - any damage ground that doesn't prevent being frozen
        - cracked ground

    - Fire damage burns players/enemies
        - Only one burn effect tracked, new ones replace old ones if they would do more damage than what remains
        - Burn does damage over 2 seconds
        - If the hero has spirit energy, half of burning damage is instead taken from spirit energy at 10 spirit per 1 point of damage,
        modified by spirit loss coefficient
        - If the hero has iron skin, burning damage applies to spirit energy, and the health portion is ignored.
            - Burning damage applies to iron skin life if player is out of spirit energy
        - If the hero has cloak up, they cannot be burned but fire attacks deal 50% more upfront damage to cloak.
        - Fire blessing reduces burns on player to half damage over 1 second.
        - Burning damage does not cause and is not prevented by iframes

    - Allow sneaking into grand temple with invisibility
        - Ultimately this should be a narration box that causes the guard to say Vanara cannot enter the temple.
        - Make sure rolling doesn't let you pass

    - Idea to fix small hit immunity from preventing larger damage:
        - When setting iframes, record the damage that caused it.
        - When something takes a hit and has iframes, if the damage is greater than the previous iframe hit,
            take damage equal to the difference, extend iframes, and record the greater damage amount.

    - Upgrade entrance randomizer to support complex connected exit graphs.
        - Currently it only supports connected exits that can be traveled in all directions.

    - Improve projectile interactions
        - Set stopX/Y when stopping a projectile which will prevent them from appearing to into cliffs/walls that they hit.
            - if stopX > hitbox.x and direction is left, adjust x by the difference, similarly for other directions.
        - Creating a projectile while standing over a ledge won't register it is high because it never hits the ledge.
            - Maybe add a function that runs hits for 8px before the projectiles starting position that we run when it is
            created to set isHigh, then clear passedLedgeTiles in case that was set to avoid accidentally throwing up ledges.
        - Right now ledges block attacks anywhere in the tile rather than just when they are on the ledge, additionally only true values apply instead of both true+false values.
            - You can observe this by standing halfway off a cliff then turning away from the cliff and attacking with chakram/bow

    - Projectiles should be able to shoot down over solid ledges, but not up them
        - Make solid ledges actually ledges but prevent jumping over them
        - Might have to implement this as a one way ledge to prevent the down ledge from causing the player to ignore walls.
            - Does not allow jumping down
            - Blocks moving into as if going up a ledge
            - Could implement with solidLedges+solidDiagonalLedge

    - Add underwater mechanics
        - allow swimming over low/medium barriers (set floorHeight to 16px on these)
        - Swarms of fish that are composed of fish shaped particles that chase the player
            - Hitting them destroys a couple of particles and slows the fish down but does not destroy them
        - large turtle monster
            - spawns up to 2-3 small swimming turtles that chase and attack you with 3-4 hp a piece
            - does a 2s spinning aoe bubble attack (like void frost) on 6s cooldown
        - simple medium fish monster that just wander around like snakes.
        - medium sword fish that moves back and forth and speeds up if you are lined up with it

    - Add additional uses for true sight
        - Invisible path tiles over pit that are revealed with true sight
            - Requires a new 'invisible' tile behavior
        - Invisible moving platform puzzle, possibly in spirit sky, or hype cave
        - Rolling ball puzzles that can be solved by moving an invisible pot
        - Invisible cracked doorway to a new cave in spirit world.
            - To prevent memorizing this in randomizer, we could randomly place the door in four different places that are inconvient to check
                - For example, they might require you to jump down a cliff to check if the door is there.

    - Add meteor attacks that leave behind rocks to void tree fight
        - Give to tree + voidFlame
        - Use smaller versions for enrage mode when voidFlame is active
        - Reduce number of rocks in the golem fight and add this attack to it

    - Spawn up to 2 Lightning Drones in void tree fight

    - Add punching fist attack to void tree rage phase if voidStone is active

    - Restrict laser barrage to if voidStone is active. Change it to be single bursts of 4 that can occur multiple times per phase. Slightly increase delay.

    - Add void pit tiles and use them in the void area, add solid cliff edges to prevent jumping into the void.
        - This will allow the astral projection to move freely over the void.

    - Holy Sanctum Improvements
        - Add phoenix boss before phoenix crown prize
        - Add sanctum tower with bow in big chest
            - Include hybrid material/spirt world puzzles

    - Mysteries
        - Lava appears under floor 2 in the middle of void tree fight
        - Certain tiles can be frozen in lava on voidFlame
        - Enemies reset when collecting the staff tower.

    - Increase world map super tile size to at least 48x48 bu try 64x64
        - Change crater to single 64x64 tile if it is supported

    - Add crucible to the end of the Grand Temple

    - Add 'only' visibility option to layers that hides everything else when selected.

    - Add full buildings to Summoner ruins in Spirit World.
        - Wait for new building tiles before doing this.
        - Populate with War God Alcolytes and the Progenitor Spirit

    - Add some additional requirement for completing crater to put the boss out of logic with few items.
        - Switches that can only be hit with staff or clone throw + iron boots

    - test staff interactions with ledges.

    - Prevent grabbing tiles/objects across ledges
        - on grab, check if the player can move into the object by running the movement algorithm with a special mode that ignores all normal collisions and prevents crossing ledges in any direction. Prevent the grab if this movement check fails.

    - Cloud jumping near the edges can sometimes result in landing poorly either taking damage or underground in a ledge. Would be nice to find a way to clean up jumping from ledge to ledge.

    - Allow destroying light stones when landing with iron boots?

    - Drain all lava in the crater when the fire beast isn't spawned yet?

    - Allow walking on clouds/cracked ground while invisible?
        - Would have to be careful in sky not to run out of spirit energy
        - Might be difficult to tell if checks are in logic based on mana bar
            - Could add special logic check against specific max spirit amounts to simplify this.

    - Mine cart mechanic with switchable tracks.
        - Or maybe a pipe puzzle with lava flow in the forge. Maybe NPC asks for help fixing the pipes.

    - Dungeon with super tile that is just the vertical face of a cliff/tower/tree that you can climb up/jump down to change floors.

    - Add some speaker name so it is clear who is talking in cut scenes with multiple characters.
        - Add this to cut scene with Elder+Rival

    - Update logic to account for clone throw over obstacles?
        - Wait on this until we have adjusted any obstacles we don't want to allow this for.

    - Cocoon boss
        - Make astral projection spawn from the boss small, grow, then approach the player to attack
        before becoming small again and returning to the boss.

    True sight
        For now try just rendering all spirit world objects at 50% opacity.
        Probably allow toggling it off in the menu, possibly a quick command like B_MEDITATE + B_ROLL

    Puzzle ideas
        - Send a clone into the spirit world for "temporary" true sight. Might be annoying to switch between.
        - Some kind of hazards in the spirit world that move slowly and knock you back, where you need true sight to navigate successfully because spirit sight is too slow.
        - Use a clone to stand on a switch to hold a door open.
        - Use a clone to jump off a cliff to press one switch, then destroy it and make another clone to jump down another cliff to press another switch to open a door at the top of the cliff.

    Change prep animation for explosion
        charge particles form randomly in a circle around the hero shooting into them,
        with shorter radius and more density as time passes.

    Gold Armor Upgrade
        If Spirit Chakram is fully upgraded and the player has golden mail they can use:
        500 Jade + 2 gold and 5 silver to double effectiveness of golden mail

    Editor Improvements
        - Track which zones have been changes since the last time they were exported
            - Show indicator that zone has "unexported" changes.
        - Save changes to zones to local storage and prompt to apply them when starting the editor.
        - Support undo/redo actions
            - Include in context menu when editor is active
        - Add graphical palettes
            - (low priority) super tile layout selection

    - Add SFX when the MC is damaged

    - Add sleeping Vanara to the Cocoon.
        - Can use a special NPC that doesn't face you when talking for now.
        - Use a variety of colors.

    World Tree
        Tower is a series of 2x2 super tiles with a vine for climbing to the next section that
        Floor 1 is land level + underwater(in material world)
            - Fight frost beast and destroy heart before advancing.
        Floor 2 is sky level + has unlockable exit to sky (in material world only)
            - Fight storm beast and destroy heart before advancing.
        Floor 3 is atmosphere level + is hot
            - Fight flame beast and destroy heart before advancing.
        Floor 4 is lower orbit + material zones have low gravity
            - Fight all elemental beasts together without hearts
        Floor 5 has final boss
        - Giant tree grows just to the north of the war temple and into the sky, occupying unused spaces in the SE corner of the map.
        - Climb giant vines in the tree to reach the top
        - Lower level parts may have parts where you go out and branches so you can see how high up you are getting
        - Tree is a clone of the helix, but allowed to grow to completion this time.

    World Tree Boss Void Beast
        - Possible 3 phase approach
            - Void tree, Outer shell, defeat to open up a pit to reach the heart
                - Takes place on most of a super tile
                - Has four sub targets that can be destroyed to temporarily disable some of its attacks/defenses
                    - Possibly starts with 2 and spawns 3 during second phase and all 4 for final phase.
                    - Which ones spawned are random, but deterministic for each seed.
                    - Targets are neutral, fire, ice, lightning, and enable different defense/offense mechanics.
                - Lots of large attacks to dodge while you navigate the arena
                    - (neutral) golem hands, Laser beams
                    - Fire walls, lava ground
                    - Lightning strikes, lightning barriers
                    - Frost grenades, ice walls
            - Void heart, defeat to relase the final boss
            - Void beast
                - maybe looks like a carnivorous plant with a giant mouth full of teeth and a bunch of tendrils like scorpion tails.
                    - Could use this boss design for the forest temple if not here.

        - Fight takes place on most of a full super tile, but each section of the fight is on a smaller platform in the material world where the player damages the boss and avoids various attack mechanics.
            - Maybe the battlefield is even taller than a regular super tile and the player must keep advancing tiers sort of like the final battle with the statues in ff6.
            - Each tier could focus on a different pair of combat mechanics like staff + iron boots, and each travel section could focus on different movement mechanics
        - After a certain amount of time/damage, the boss phases and requires the player reach another platform to damage it, which becomes more difficult as the phases progress, eventually requiring the player to use portals to the spirit realm to cross platforms provided by NPC helpers to reach the next platform.
        - Elemental weak spots that must each be hit to briefly expose the main weak spot.
            - Start with a single spot + 1 element, and advance to up to 5 across all 3 elements.
            - Can arrange them differently to benefit different tools.
        - Aided by Champion initially and then Vanara Rival during the last phase.

        Must rescue Champion and work together to defeat the boss
            - Mechanics where one of you creates an opening for the other to damage the boss.
            - Mechanics where you protect each other from boss attacks.
            - Failure to protect champion will:
                - Require completing a rescue mechanic or waiting long enough for her to free herself
                - Cannot benefit from champion mechanics for damage or protection while champion is out of comission
        Phases where specific elements are required to damage it.
        Phases designed for each tool, but does not require them
            - Tools can give extra opportunities to damage the boss
                - Barrier to reflect projectiles/protect champion while they attack.
                    - Maybe a mechanic where you put up a barrier and reflect attacks while she prepares a strong attack against the boss
                - Bow to shoot distant weak spots
            - Tools can make it easier to avoid attacks

    Lab + World Tree Notes:
        - Requires all elements to complete
        - Fight rival near the start to claim the last element
        - Possible flow:
            Enter throne room of the War Temple in the Spirit World and fight rival, get last element and open tunnel entrance.
                - This step is only completable after fighting the rival during the 3rd spirit beast battle.
            Tunnel takes you to the lab where the War God's Scientists have been creating Hybrdid creatures and have made a modified World Tree Seed from the Helix.
            Can(must?) find clone upgrade to complete the lab.
            The seed is activated(possibly by combined proximity of champion+MC) and grows a giant tree that MC must climb to rescue the Champion and stop the War God.
            The War God will use the engine to make a breeding ground for his drone soldiers, the MC might use it to synthesize the Vanara and Native life to coexist.

    - Flying enemies should not move over abyss tiles(make abyss tiles + ceiling tiles impassable to flying enemies).

    Peach Cave improvements
        - Add new graphics to 2F
        - Fix spirit world tiles
            - Add 4 easy checks to top floor and bombable pit entrance to basement
            - Require Mitts for entering from the bottom floor.
            - Add harder beetle boss with a Peach piece on it
            - Add 3 checks behind different tool combinations
                - cracked ground for cloud boots/ice magic
                - staff or teleportation to get across pits
                - bow+torches or fire element to unfreeze a chest

    - Add behavior that prevents non-flying enemies from crossing tiles/objects, use for cracked ground, escalators, bead cascades, etc.
        - Anything that doesn't handle enemies gracefully either needs to keep enemies out or add handling.

    Storm Beast
        - Storm Beast can turn into lightning and teleport as a beam sending shockwaves out at both ends.
        - Storm Beast can charge south to exit the battle field

    - Game occasionally plays small bits of music while muted.

    - Make sure ice tiles are removed from frost beast+heat sink battles after they are defeated.

    - Add new hold+walk chakram animations
        - play last 2 frames of attack animation on release.

    - Work on new waterfall graphics
        - Email Jon about waterfall graphic updates.


Combat Ideas:
    - Concentric damaging rings that collapse into the player. Player must time it so that they are close enough together to dodge roll through in order to avoid damage.
    - Rolling enemy that leaves a trail of ice/fire behind it and bounces off walls. Hitting it knocks it in different directions.

Minigame Ideas:
    - Add Vanara VR dream world with mini games.
        - Boss practice
    - Could add something like an AR arcade to spirit city


Staff Improvements:
    - Charging staff 2 should show a preview of where it will hit and get wider in addition to longer
        - This should start at 4x1, 5x1 then 6x2->10x2, 11x3->15x3, 16x4->20x4
        - Preview will only show the max size that will fit in the current space
        - Ideally you could move around while charging and the preview will update appropriately
        - Would be nice to have this preview behavior when holding down the staff button for staff 1.

Throwing an object into a pit should use the pit animation rather than breaking.

Respawn improvements:
    Only adjust respawn when in the same screen area as the spawn point.
    Or possibly only adjust respawn when using specific doors.
        Map dungeon entrances to respawn points?

Tutorial Improvements:
    - chest instructions are lost if you exit without obtaining the chakram.
    - no instructions for picking up objects before obtaining the glove
    Add advanced combat/tool tutorials
        - Maybe NPCs in home cave, or some kind of training/tutorial dojo?
        - Hitting enemies with chakram held in hand
        - Default Charged chakram attack
        - Enemy iframes prevent them from damaging you
        - Maybe different sections for different tools.
        - Reflecting projectiles

Add more screen shakes:
    - Lava draining transition
    - Probably for some impactful boss attacks.
    - Maybe when falling from a large height.
    - Scene where elemental beasts escape and attack the holy city
        - Maybe could be periodic large shake+explosion as if there is a large explosion nearby
        - Could have different combination of effects to signify attacks from each type of elemental beast
        - Could make sure these effects are also used when actually fighting the beasts for consistency

Improve Staff Tower Setup:
    - Maybe should create a staff tower object and use this instead of the current layer solution
    - Then we can detect if you are facing the object and not standing inside it to deploy the tower.
    - Would force the tower to look consistent and make it easy to update when we have better graphics
    - Can also detect zone overworld vs sky to create the upper+lower parts correctly.
    - Can render consistent ground graphics for when the tower is not present.
    - Animation should be throwing staff into the sky as it grows with its shadow, then falls to the ground when the shadow is as large as the foundation.

High level list of things left to do:
    New dungeons(need enemies, mechanics, bosses, entrances):
        Sky Palace
        Forge
    Areas missing significant content:
        Forest Temple
        River Temple
    Missing Bosses for existing areas:
        Phoenix boss in Holy Sanctum
        Eight Trigram Furnace at the end of the Gauntlet
        Crater midboss
        Rival fight before Helix
        Helix Boss
            - Instead of fighting this boss, you will see it, but then abort because of the beasts attacking the city
            - Then you will actually fight this boss at the end of the Grand Temple or Jade Palace or possibly as a mid boss on the Warship.
    Missing mechanics:
        - Vanara dreamland boss simulator with difficulty modifiers
        Hero helping during first elemental beast fight
            Hero wears monk fighting attire
            Creates a spirit barrier during rage phase that MC can hide in to prevent all damage
            Attacks or distracts the beats while fighting the heart
            Adds dialog cues for guiding the MC to destroy the heart
            Heals MC or restores MC spirit energy periodically
        Rival during last elemental beast fight
        Spirit Gates + Spirit Keys
        Spirit shop + Jade Idols
        Treasure Hunter Shop
        Fertility shrine donations
    Items missing implementation:
        Charge level 2
            Bow charge 2 shoots 5 arrows in 120 degree arc -60, -30, 0, 30, 60
        Clone charge 1 + 2
        Gloves charge 1 + 2

Generic boss improvements
    - Add vulnerable phases for bosses where they take ~5x damage, increase boss health by ~2x

Lava improvements:
    - Temporarily create solid ground when hit by ice.

Misc improvements
    - allow facing diagonals while not moving?

Add toasts to development for undoing actions:
    - Deleting layers
    - Replacing > 100 tiles


Simple randomization ideas:
    - Randomize tippable pot in war temple 2F
        - Make sure true sight reveals this.
    - Allow floor switches under covered tiles, randomizer the location of a floor switch to open a door.
        - Make sure true sight reveals this.
    - Place a key under a random pot
        - Make sure spirit sight reveals this.

Treasure Hunter Store
    - Initially can only carry 200 coins
    - Treasure hunter sells
        - Full life for  20 coins
        - 500 coin wallet for 50 coins
        - 1000 coin wallet for 200 coins
    - The first time you find money in a chest that would exceed wallet size you find a coupon from the treasure hunter for the value of the chest advertising his store.
    - Future chests that would exceed your wallet size contain treasures that you can sell to the treasure hunter for the value of the coins from the chest.
    - Every 5 chests containing money unlock new items in the treasure hunter store
        - Peach Piece for 100 coins
        - 1000 coin wallet for 200 coins
        - Jade Idol for 300 coins
        - Lodestone necklace (50% damage from lightning attacks) for 500 coins

Fertility Shrine
    - Donate 50 coins at a time in the material world
    - Chests will appear in the spirit world based on the total amount donated
        50 -> Jade Idol
        100 -> Peach Piece
        200 -> Spirit Key (cannot donate more than 200 coins)

Spirit Store(s)
    - Items might be split between different vendors
    - Trade Jade Idols for items
        2 -> Peach Piece
        3 -> Spirit Key
        5 -> Quick Charge (40% reduction in time to charge)

Charge Chakram Attack:
    - Maybe change level 1 charge to spin around hero in a circle twice? Brief 0.5s invulnerability with attack animation.
    - Charge level 2 could have 2 chakrams spin at different radiuses and directions? 50 mana, lasts 4 seconds.

At some point I should write tests to validate certain things like:
    - All zone+object targets are defined.
    - All bombable + locked doors have ids, all objects with saveStatus set have ids.
    - All objectFlags correspond to some object or dialogue key or loot type
    - All escaped dialogue corresponds to a special frame or loot type.

Clone improvements
    Add particle effects when using the clone tool (+animation eventually)

Additional Clone Tool Behavior:
    Charging the clone 1 level adds elements to the clones weapon/tools/explosion.
    Charging the clone 1 level without elements makes it invulnerable for 4 seconds.

Additional Bow Behavior:
    Arrows should have stuck frames for diagonals or stick out orthoganal to whatever they hit.
    Charge level 2 creates an elemental explosion
        - Neutral element can destroy objects similar to clone explosion.

Peach Cave Improvements:
    - Add enemies:
        - Eggs that hatch into enemies if not destroyed first
    - Sticky Web Ground
    - Add boss:
        - Spawns eggs
        - Drains light and regains a bit of health for every 25% lost

Dungeon 1 Improvements:
    - Update arrow turret graphics.

Golem Boss Improvements:
    - Tighten up timing when switching between attacks
        - Cut short any hand actions that aren't close to completion when starting enrage modes.
    - Slam both hands together
    - Quickly slam both hands in succession a single time.
    - Knocking bolders down from the ceiling (use rock riles + rock particles when they break)
        - Could drop some down for certian fist slam attacks
        - Could have the boss slam against the walls when strafing side to side or raise entire body and slam ground to drop stones.
        - Could also drop additional permanent barries that reduce the safe zones on the sides.

Dungeon 2 Improvements:
    - Add more uses of spirit sight:
        - See actual elemental beasts in the front room where the statues are located.
        - Some kind of optional spirit sight puzzle for a peach piece.

Dungeon 3 Improvements:
    - Add a required progress puzzle defeating enemies with rolling stones using spirit sight.
    - Add new enemies.
    - Make the guardian's projection use more interesting attacks.
    - Animate the ents when they attack.

River Temple Improvements:
    - Some underwater enemies
    - Some crab enemies with ice shells that require fire element to defeat
    - Floating ice spike obstacles that hurt you when floating into them and prevent passing through.
        - Allow swimming over stones and then use these to prevent swimming movement where it makes sense.
    - Maybe torches should stay lit during the boss fight once turned on.
    - Add special behavior for frozen doors instead of having two door objects.


Staff Tower Improvements
    - Add content to 4F Material world, probably some sort of gauntlet that is easier when the boss is defeated.
        - Should have a short cut so it can by bypassed after completing once.
    - All machine enemies have an offline state where they cannot be damaged, and possibly can be pushed around.
        - Hitting offline machines with lightning will turn them on.
    - Conveyer belts/escalators.
        - Conveyer belts should also effect movable object/enemies on the ground touching them.
        - Ice magic can freeze the conveyer belts which stops them but makes them slippery.
        - Lightning magic will turn a conveyer belt on if it is off.
    - Disabled conveyer belt with pots on it that needs to be turned on to move the pots out of the way.


Crater Improvements
    - Add animation for draining lava
        - Add a layer for each frame of the animation, but only on the screen lava can be drained on
        - Run a script that switches to each frame with a fairly quick fade transition.
    - Add platforms floating on lava.
    - Add peg switches that require hitting with the staff to activate, replace all regular switches with these.
    - Add Flame Guardian enemies
        - Stationary like Crystal Guardian
        - Replace ents with Flame Guardians
    - Lava Fireballs that spawn from lava in an anulus around player about ever 4 seconds
        - Rise into the air then explode into 8 fireballs.
    - Add Shepard's Maw enemy
        - Like a carnivorous plant in the spirit world
        - Projects fake enemies on tendrils into the material world to herd prey to its mouth
            - Fake enemies attack with projectiles or hot gas
        - Bites into the material world when the prey is near
        - Kill by evading the maw attack and then hitting it while it is briefly in material world
            - Or fight it in the spirit world if you are there
    - Add heat sink enemies
        - Like ghosts in material world
        - Become solid+vulnerable when they try to pump heat from the material world
        - Can turn lava tiles solid briefly, or solid tiles to ice
        - Will try to chase and freeze the player if they get near
            - Will lose interest in the player while frozen
        - 1 or 2 second cool down on freezing anything
    - Add Engorge Heat Sink mini boss
        - Giant heat sink that is cooling one of the under lava caves you uncover
        - 4x as large and slow, but shrinks and speeds up as damaged
        - About 2x faster than normal heats sinks at minimum size
        - On defeat it possesses the player giving them the "Cooling Spirit" ability (Fire Blessing).
        - The cave becomes hot again after the boss is defeated but they player is now immune to the effect.

War Lab
    - Praying Mantis-like bug soldiers
        - Can emerge from tubes when security beams are triggered in certain rooms.
        - Defensive stance with crossed arms that blocks most attacks
        - Leap strike attack in any direction
        - Possible dodge + Leap strike instead of blocking attack (like electric squirrel dodge)
        - Spinning Scythe projectile attack

Multi-area Boss ideas:
    - Plant-like boss that is growing in several chambers that you have to move between to defeat.
    - Boss that escapes and must be chased to different chambers.

Add Small Loot to editor that creates LootDrop
    - locked to tile grid
    - if on destructable tile (cuttable, pickup), not rendered/updated until the tile is destroyed.
        - This should actually be done for any loot, this will make it easy to hide keys under objects.
        - We can support progress items under tiles, but probably shouldn't actually use this in practice in order to avoid players searching under every tile. On the other hand, if we clearly telegraph when this happens, maybe we can void this problem and encourage players to use smart ways to check for things (like spirit sight to search under many objects for a key).
    - Default save status to dungeon
    - Add an editor option to clear the history of picked up small loots.


Add ability to charge carried objects
    Hold the passive button when picking up an object to charge
    Charge level is limited both by level of gloves/bracers and charge level.
    Should add selected element to thrown object
    Apply element changes to tiles while you hold them (bush might burn up into ash in your hands with fire element, or turn to ice)


Improve Tool Selection:
    - Color around the selection + HUD indicator should match the color of the controller button (blue + yellow for X-Box)
    - Display a letter attached to the selection based on the button/keyboard key.

Additional Staff Behavior:
    - The sides of the staff should function as a wall rather than open ground.
    Charging the staff does a very large spin attack that knocks enemies away.
        Lvl 2 charge is a screen wide attack the applies damage+element to all enemies.
    Top N pixels of character should be drawn on foreground as well so that it appears in front of staff when facing north.
        - Probably should disable staff when character is standing on any tiles marked with low ceiling just in case.

Some puzzle ideas:
    - A puzzle where 4 switches need to be hit in 200ms, you can blow up the clone in the middle to activate all at once.
    - If we place a block on top of a switch that toggles on release, we can make a door that requires you to push the block off of the switch.

Animate hearts refilling

Add spirit element that replaces the default 'none' element when the upgrade is found. In vanilla this would require getting all other elements first.

Idea:
    Objects you can bounce off of when jumping
        - Just make them solid and knock the player back a bit if the player's y velocity is >= some value?

Support 64x64 super tiles for world map. Or maybe just 48x48.

Possible tool: Leather gloves protect you from thorn bushes.
Possible tool: Leather boots let you walk on thorny ground without taking damage.

Paths to Elemental Beast Dungeons:

River Temple:
    (Implemented) Iron Boots(Waterfall Tower) -> Peach Cave -> Underwater Entrance
    Cloud Boots(Forest Temple) + Fire(Crater) -> Crater sky path to Temple roof opens after defeating Fire Elemental
    Cloud Boots(Forest Temple) + Lightning(Staff Tower) -> Tower B sky path connects to Temple roof


Staff Tower:
    Fire(Crater) -> Blow up pots in front of escalator using fire on explosive plants
    (Implemented) Clone(Forest Temple) -> Blow up pots in front of escalator with clone
    Ice(River Temple) -> Use ice magic to freeze the down escalator and walk up it.
    (Implemented) Cloud Boots(Forest Temple) -> Use cloud boots to walk up the down escalator
    Cloud Boots(Forest Temple) -> Sky path from Helix to Tower Balcony

Crater:
    (Implemented) Cloud Boots(Forest Temple) -> Sky path from Helix to Crater Peak
    Cloud Boots(Forest Temple) + Tower Staff(Staff Tower) + Ice(River Temple) =>  Tower B Sky path connects to Crater Peak
    Ice(River Temple) -> Use Ice to pass lava in cave to Crater Peak


Dungeon flavor philosophy:
    All Vanara structures are part of the Vanara ship and related to some functionality, such as the regeneration pods.
    All Native structures are built to native spirit gods who functioned as servants to the old native spirit beings and were created for specific purposes like resource harvesting, processing and crafting.


Ability Locations:
# Prologue
    weapon 1            Peach Cave Chest
    catEyes             Peach Cave Boss
# Starting Dungeons
    bow                 Vanara Village
    roll                Vanara Tomb Chest
    spiritSight         Vanara Tomb Boss
    gloves              Summoner Ruins Chest
    astralProjection    Summoner Ruins Boss
    spiritCloak         Cocoon Chest
    teleportation       Cocoon Boss
# Treasure Dungeons
    cloudBoots          Forest Temple Chest
    clone               Forest Temple Boss
    ironBoots           Waterfall Tower Chest
    spiritCloak 2       Waterfall Tower Boss
    True Sight          Gauntlet Chest
    ironSkin            Gauntlet Boss
    gloves 2            Forge Chest
    goldMail            Forge Boss
    roll 2              Cloud Temple Chest
    nimbusCloud         Cloud Temple Boss
    bow 2               Holy Sanctum Chest
    phoenixCrown        Holy Sanctum Boss
# First Quest Dungeon
    staff               Helix Chest
    weapon 2            Helix Boss
# Middle Quest Dungeons
    fireBlessing        Crater Big Chest
    fire                Crater Boss Flame Beast
    waterBlessing       River Temple Big Chest
    ice                 River Temple Boss Frost Beast
    lightning           Staff Tower Boss Storm Beast
    staff 2             Staff Tower "Chest" (after boss)
    charge 1            Acquired with first Element
    charge 2            Acquired with third Element
# Final Quest Dungeon
    clone 2             Hidden Lab

Dungeon 1: Vanara Tomb (fortress around the Cocoon)
    - Traps+locks to keep intruders away. Need to use bow to enter
        - Someone was stealing Vanara remains
    - Built around a suspended animation capsule
        - The Vanara population is too large so they rotate members in and out of suspended animation.
        - Suspension pods erase Vanara memories to prevent then from becoming restless.
        - Pods also regenerate Vanara bodies, which would break down without nurishment from the spirit world.
        - Vanara village population is 20-30 individuals at a time. There are 100-300 total, most suspended.
    - The goal of the dungeon is to meet with the care taker who looks after and maintains the suspended Vanara.
        - The original Vanara crew rotate members into the care taker role once every X years.
    - A facade is built aroaund the structure to disguise it as a mundane structure
        - The Vanara village posts guards in addition to the traps to keep people out
    - MCs father refused to go back to sleep, having fallen in love with MCs mother and not wanting to forget about her.

Jade Palace:
    - Boss Reward: Phoenix Feather
        Uses a feather from a legender spirit beast that could survive on its own in the material world and once threatened to destroy the world.
        The War God wants to combine science and Vanara biology to make a new "Void Phoenix" to replicate the old beast.
        An ancestor of the MC+Hero defeated the original Phoenix
        The feather is kept in the Jade palace, too dangerous to use but too precious to destroy

River Temple:
    - No NPCs here, this was the old Fertility Temple, but it was destroyed by the Vanara Ship crashing. The survivors all moved to the new Fertility Temple near the forest (Forest Temple).
