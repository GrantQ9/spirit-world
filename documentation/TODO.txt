Test at http://localhost:81/alttp/public/

Bugs:
    Fix tiles should also be reset when leaving an area section.
    Pushing on a solid object sitting on thorny ground shouldn't hurt you:
        -return tileBehaviors and objectBehaviors separately, only damage if tile is solid+damaging.


Add Particles to tile behaviors as array of frames. Use one of each frame when tile is destroyed. Include multiple copies of the frame in the particles array if we want duplicates of any frames.

Update collision detection and wiggle logic:
    - Create an array that is the width of the character(relative to movement direction) + 16
    - Assuming entry 8 = [ax, ay] and length - 9 = [ax + width - 1, ay] (for moving up or down) check pairs of 0 and 3 pixels every 4 pixels, so for w = 16, check 8+11,12+15,16+19,20+23. If any are blocked, movement is blocked, remember the blocked pixel index.
    - If movement is blocked if blocked index <= length / 2 then scan right starting at blocked index + 1. If w open pixels are found, wiggle right. If a blocked pixel is found at index >= length - w, then abort, wiggling is not possible.
    - If blocked index > length / 2, repeat the above except scanning left to check for left wiggle.

Add Small Loot to editor that creates LootDrop
    - locked to tile grid
    - if on destructable tile (cuttable, pickup), not rendered/updated until the tile is destroyed.
    - keep a hash of picked up objects in dungeons so these only replenish on leaving the dungeon.

Door floor switch behavior:
    - for floor switches, toggle status when the floor switch toggles
        - For floor switches that toggle when pressure is removed, this requres leaving the switch pressed by placing an object/clone/staff on top of it.

Add ability to charge weapon
    Spin chakram around quickly in a circle twice (can move after throwing)
    Costs 10 mana

    Charge level 2 requires level 2 charge ability + level 2 weapon
    Costs 50 mana
    Similar to level 1 but 2 chakrams spin around you at different radiuses for 4 seconds.

Allow selecting an element using the L/R triggers
    No element is an option and the default
    Apply element to charge abilities.
    Costs an additional 10 mana for the element
    Add elemental crystal objects that are faded red/blue/yellow and become vibrant when hit by element
    When all crystals in a room are activated, hiddenSwitch elements appear.

Add ability to charge tools.

Add ability to charge carried objects
    Hold the passive button when picking up an object to charge
    Charge level is limited both by level of gloves/bracers and charge level.
    Should add selected element to thrown object


Add meditate ability
    - stand still and hold the passive tool button to grow a ring of spirit sight around you
    - release and press passive tool button to stop
    - if astral projection is available, you can move around (need to press passive tool on body to return or press somethiing else to return instantly?)
    - if telekinesis you can pick up real objects (possibly limited by telekinesis level)

Add example prologue area:
    - Add text boxes
        - Space/shift/enter to advance/dismiss
        - On start
        - On pickup item
    - Floor switches to open exit from area that gives roll technique
    - NPC that gives weapon?
    - Peach of Immortality at the end

Add connected areas + dungeons

Support 64x64 super tiles for world map. Or maybe just 48x48.

Improve Tool Selection:
    -Track most recent input to control keyboard vs controller type
    - Color around the selection + HUD indicator should match the color of the controller button (blue + yellow for X-Box)
    - Display a letter attached to the selection based on the button/keyboard key.

Additional Clone Tool Behavior:
    Can pick up + throw clone, clone can pick up and throw the hero.
        -> Trying to move while held by the clone
    Holding the clone tool down allows controlling all clones at once.
    Holding the passive button (as if to meditate) will detonate the current clone for AOE elemental damage.
    Charging the clone 1 level adds elements to the clones weapon/tools/explosion.
    Charging the clone 1 level without elements makes it invulnerable for 4 seconds.

Additionl Invisibility Tool Behavior:
    Charge to deal elemental damage on contact while invisible.
    Can move through activatable crystals and some other obstacles.
        * charge invisibility then dodge roll through a line of crystals to activate them quickly.

Additional Staff Behavior:
    Should damage enemies + knock them away
    Eventually Lvl 2 staff can be used to create the Staff Tower.
    - The sides of the staff should function as a wall rather than open ground.
    Charging the staff does a very large spin attack that knocks enemies away.
        Lvl 2 charge is a screen wide attack the applies damage+element to all enemies.

Some puzzle ideas:
    - Have a puzzle for the clone tool where a crystal deactivates after only 1s but cannot reach the door unless you stand at the door and have the clone hit the switch.
    - Similarly a puzzle where two switches must be hit within 1 second to make a chest appear. This could use the clone or an arrow.
    - A puzzle where 4 switches need to be hit in 200ms, you can blow up the clone in the middle to activate all at once.

Add animation for breaking stone hitting the ground.

Track the object an arrow is stuck in and move it with that target until it disappears
    - Use a different 'stuck' frame for the arrow missing the head.

Animate hearts refilling


Allow player to choose difficulty during the opening by completing tasks:
    - Solve more difficult puzzle to set puzzles to difficult
    - Complete more difficult enemy encounters to set combat to difficult
    ?? Complete opening without picking up a weapon to set to weaponless mode ??
    - Maybe add an option to manually change the difficulty later just in case.

Include some random dungeon design in the base game:
    - Location of key under object might change (there should be some clue where it is or use spirit sight).
    - Something like peg cave, but only a single peg needs to be pressed to open it (spirit sight reveals which?).
    - Something like Easter Palace Foyer except the correct door isn't always the center door.

Keep in mind significance of design elements for future racing/randomizer.

Add quick tool select ring on the right analog stick.

Possible tool: Leather gloves protect you from thorn bushes.
Possible tool: Leather boots let you walk on thorny ground without taking damage.
