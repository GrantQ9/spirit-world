Test at http://localhost:81/alttp/public/

Known Bugs:
    - Clone tool bugs
        - Mana regen is wrong when using clone tools (seems to multiply consumption/regen by number of clones)
        - Should destroy clones when the clone technique is unequipped.
        - Clones should all share the same tools (store tools on state instead of hero)
        - Unable to charge weapon while clones are active, multiple clones don't attack at the same time
        - Staff won't be placed when controlling multiple clones (one places, another retrieves?)
            - Should probably just have the primary clone place the staff
        - Check if multiple clones can charge weapon + fire bow
    - Picked up items are invisible while using cloak
    - Piercing projectiles that can push things should be stopped by the first object they push
        or not be able to push additional objects, for example, the charged chakram.
    - Enemies can walk on stairs cases and over bead flows
        - Add an invisible enemy wall object?
    - Astral Projection appears in front of waterfall graphics only when south of main body in waterfall tower.
    - Pushing on a solid object sitting on thorny ground shouldn't hurt you:
        -return tileBehaviors and objectBehaviors separately, only damage if tile is solid+damaging.
    - nextAreaInstance is not rendered in Safari
    - Enemies with small hitboxes are checking pixels outside of their hitbox while moving.
        - For example snakes when moving left/right will be forced to move up if there is a wall to their south.
    - Some water instead of ice west of the lake in the spirit world.
    - Can get to undefined area in city by sinking in the water.
    - Cliff Edge issues:
        - Would be nice if staff could go across edges.
        - Bow can fire up thin cliffs
        - Bow cannot fire down southern cliffs.
    - Projectiles can fire in between black abyss tiles, for example, shooting a bow at an east or west wall it may go through instead of stopping.

Graphics:
    Add slam effects for the staff.
    Sweat animation when pulling on something you cannot move.
    Add Item Get Frame gfx/wukongimportantitem.png 20x28
    Add sparkles to peach loot + hud.
    Add damage effects for hitting enemies?
    Add damage effect for player hurt? (alttp doesn't have anything like this)


Current tasks:
    Staff Tower
        - Add check to 3rd floor spirit world only reachable from elevator, 100 coins
        - Make sentry bots defeatable and include them somewhere in the upper spirit world floors
        - Flying enemies should not move over abyss tiles(make abyss tiles + ceiling tiles impassable to flying enemies).

        - conveyer belt + cloud boots puzzle (probably spirit 3 right side),
            - Floor is fast moving conveyer belts that will return you to start if you land
            - Walls are lightning that will knock you onto the belt so you have to navigate using the cloud boots without running into any walls.
            - Instead of walls we could use pits to be less heavy and simpler to deal with
            - Can be easily solved after the boss is defeated with barriers disabled and
            - required path on the left could use slow moving

        - Create path to elevator entrance:
            - 1F -> 1F Spirit -> (around broken elevator door) -> 2F Spirit (around blocked off elevator entrance)
                -> 2F Material -> 3F Material -> 3F Spirit (around chest by blocked off elevator entrance) -> 2f Spirit elevator
        - Elevator only in spirit world (similar to cocoon)
            - Trying to open the elevator on the first floor will give a message about power flow in the spirit world being disrupted by excess energy in the material world. Maybe something about starting backup power.
            - Elevator is stuck on floor 2 but you need to drop down from floor 3 to reach it.
            - Disabling emergency breaks in the elevator grants access to the basement+backup generators (mini boss?)
            - Fixing elevator grants access to upper floors, but last two floors must be done in material world to reach the roof and boss.
            - 5th floor in spirit world has device for re-activating the tower after defeating elemental beast, which is what gives access to the Tower Staff tool upgrade. This also disables all machine enemies by default.
        - All machine enemies have an offline state where they cannot be damaged, and possibly can be pushed around.
            - Hitting offline machines with lightning will turn them on.
            - Machines all default to offline except in the material world when the Storm Beast is active.
        - Conveyer belts/escalators.
            - Conveyer belts should also effect movable object/enemies on the ground touching them.
            - Ice magic can freeze the conveyer belts which stops them but makes them slippery.
            - Lightning magic will turn a conveyer belt on if it is off.
        - Sentries
            - Large robots with high health and big attacks
            - Used as barriers when not powered.
            - Can have an area with a lot of these enemies in the material world that is safer to return to after defeating the storm beast.
        -  Bi-directional spirit world portals that can only be used once activated with lightning element in the spirit world.
        - Ground level exit + sky level exit for each tower location.
        - Fast Conveyer belt puzzle with lightning barriers over it requiring you to either freeze the conveyer belts or run over them with clouds boots without getting knocked down by the lightning barriers.
        - Slow Conveyer belt puzzle with out of sync lightning barriers across it.
        - Disabled conveyer belt with pots on it that needs to be turned on to move the pots out of the way.

    Peach Cave improvements
        - Add new graphics to 2F
        - Fix spirit world tiles
            - Add 4 easy checks to top floor and bombable pit entrance to basement
            - Use crystal floor graphics in place of water when it is ready.
            - Require Mitts for entering from the bottom floor.
            - Add harder beetle boss with a Peach piece on it
            - Add 3 checks behind different tool combinations
                - cracked ground for cloud boots/ice magic
                - staff or teleportation to get across pits
                - bow+torches or fire element to unfreeze a chest

    - Add behavior that prevents non-flying enemies from crossing tiles/objects, use for cracked ground, escalators, bead cascades, etc.
        - Anything that doesn't handle enemies gracefully either needs to keep enemies out or add handling.


    - Consider adding `isActive(state, area)` method on enemy that returns true if the enemy can attack in the given area. Use in logic for removing discharge from area if enemy source is invalid.

    Storm Beast
        - Storm Beast can turn into lightning and teleport as a beam sending shockwaves out at both ends.
        - Storm Beast can charge south to exit the battle field

    Warship
        - Requires all elements to complete
        - Fight rival near the start to claim the last element
        - Possibly flow:
            Enter throne room of the War Temple in the Spirit World and fight rival, get last element and open tunnel entrance
            Tunnel takes you to the Core(Seed?) of the Vanara Ship, which has the terraforming engine
            The War God will use the engine to make a breeding ground for his drone soldiers, the MC might use it to synthesize the Vanara and Native life to coexist.
            Sub goal is to gain the upgraded clone ability, then use it to combine all three elements to continue forward.
            Final boss has phases where specific elements are required to damage it.
            Final boss has phases designed for each tool, but does not require them
                - Tools can give extra opportunities to damage the boss
                    - Barrier to reflect projectiles
                    - Bow to shoot distant weak spots
                - Tools can make it easier to avoid attacks

    - Make the staff ground raised, use floorHeight tileBehavior to control minZ+raise the shadow so they don't look like they are floating.
    - Game occasionally plays small bits of music while muted.
    - Game music occasionally doesn't pick up correctly
        - At the end of tracks
        - Transition between boss tracks

    Make mutation transition use the same area instance so contents don't reset
        - Will need to add special handling to remove extra ice tiles from frost beast+heat sink battles.

    - Probably should move hero back to safe location on reviving.

    - Randomizer improvements
        - Add configurable goal

    - Add target landing locations when falling from sky (also apply to the forest temple pits).
    - Add new hold+walk chakram animations
        - play last 2 frames of attack animation on release.

    - Add new waterfall graphics

Throwing an object into a pit should make use the pit animation rather than breaking.

Add advanced tutorials
    - Maybe NPCs in home cave, or some kind of training/tutorial dojo?
    - Hitting enemies with chakram held in hand
    - Default Charged chakram attack
    - Maybe different sections for different tools.
    - Reflecting projectiles

Add more screen shakes:
    - Lava draining transition
    - Probably for some impactful boss attacks.
    - Maybe when falling from a large height.
    - Scene where elemental beasts escape and attack the holy city
        - Maybe could be periodic large shake+explosion as if there is a large explosion nearby
        - Could have different combination of effects to signify attacks from each type of elemental beast
        - Could make sure these effects are also used when actually fighting the beasts for consistency


High level list of things left to do:
    New dungeons(need enemies, mechanics, bosses, entrances):
        Grand Temple
        Jade Palace
        Sky Temple
        Forge
        Warship
    Areas missing significant content:
        Forest Temple
        River Temple
        Staff Tower
    Missing Bosses for existing areas:
        Crater midboss
        Rival fight before Tomb
        Tomb Boss
        Rival fight before Helix
        Cocoon Boss
            - Instead of fighting this boss, you will see it, but then abort because of the beasts attacking the city
            - Then you will actually fight this boss at the end of the Grand Temple or Jade Palace or possibly as a mid boss on the Warship.
    Missing mechanics:
        Difficulty shrines for dungeons/bosses
        Hero helping during first elemental beast fight
        Rival during last elemental beast fight
        Spirit Gates + Spirit Keys
        Normal shops
        Spirit shop + Jade Idols
        Treasure Hunter Shop
        Fertility shrine donations
    Items missing implementation:
        Charge level 2
        Bow level 2
        Bow charge 2
        Clone charge 1 + 2
        True Sight (Render certain enemies/objects flagged for true sight)
        Iron Skin (slowly regenerates health shield = 20% total health)
        Gold Mail (reduce damage by 50%)
        Gloves charge 1 + 2

Generic boss improvements
    - Add vulnerable phases for bosses where they take ~5x damage, increase boss health by ~2x

Lava improvments:
    - Temporarily create solid ground when hit by ice.

Add toasts to development for undoing actions:
    - Deleting layers
    - Replacing > 100 tiles

Treasure Hunter Store
    - Initially can only carry 200 coins
    - Treasure hunter sells
        - Full life for  20 coins
        - 500 coin wallet for 50 coins
        - 1000 coin wallet for 200 coins
    - The first time you find money in a chest that would exceed wallet size you find a coupon from the treasure hunter for the value of the chest advertising his store.
    - Future chests that would exceed your wallet size contain treasures that you can sell to the treasure hunter for the value of the coins from the chest.
    - Every 5 chests containing money unlock new items in the treasure hunter store
        - Peach Piece for 100 coins
        - 1000 coin wallet for 200 coins
        - Jade Idol for 300 coins
        - Lodestone necklace (50% damage from lightning attacks) for 500 coins

Fertility Shrine
    - Donate 50 coins at a time in the material world
    - Chests will appear in the spirit world based on the total amount donated
        50 -> Jade Idol
        100 -> Peach Piece
        200 -> Spirit Key (cannot donate more than 200 coins)

Spirit Store(s)
    - Items might be split between different vendors
    - Trade Jade Idols for items
        2 -> Peach Piece
        3 -> Spirit Key
        5 -> Quick Charge (40% reduction in time to charge)

Difficulty shrine:
    - 50 money per point
    - move points around for free
    - second chance = faerie
        - 100/200/300/400 for a filled chance, 50 for a refill
    - Or second chance is only for boss, and have a single refill tank that you can charge like in metroid?
    - Remove boss webs
    - Reduce boss health
    - Take 1/2 damage
    - 1/2 boss life
    - easier traps (disable conveyer belts, remove spikes)
    - easier puzzles (required chests are made distinct from optional chests, positions of required items are moved to more easily accessible locations)

Spirit Cloak Improvements
    - Need a way to optionally enable invisibility
        - Invisibility should make you mostly invulnerable but drain mana over time.
        - No barrier while invisible.
        - Press once for a barrier, a second time to turn invisible, and a third time to disable both?
        - Press twice quickly to turn invisible?
    - Enemies should not be able to target you while invisible.
    - Make invisibility ignore certain ground effects+hazards: spikes, ice floor, fire barriers
    - Can move through activatable crystals and some other obstacles.
        * charge invisibility then dodge roll through a line of crystals to activate them quickly.

Charge Chakram Attack:
    - Maybe change level 1 charge to spin around hero in a circle twice? Brief 0.5s invulnerability with attack animation.
    - Charge level 2 could have 2 chakrams spin at different radiuses and directions? 50 mana, lasts 4 seconds.

At some point I should write tests to validate certain things like:
    - All zone+object targets are defined.
    - All bombable + locked doors have ids, all objects with saveStatus set have ids.
    - All objectFlags correspond to some object or dialogue key or loot type
    - All escaped dialogue corresponds to a special frame or loot type.

Additional Clone Tool Behavior:
    Charging the clone 1 level adds elements to the clones weapon/tools/explosion.
    Charging the clone 1 level without elements makes it invulnerable for 4 seconds.

Additional Bow Behavior:
    Arrows should have stuck frames for diagonals or stick out orthoganal to whatever they hit.
    Charge level 2 creates an elemental explosion
        - Neutral element can destroy objects similar to clone explosion.

Peach Cave Improvements:
    - Add enemies:
        - Eggs that hatch into enemies if not destroyed first
    - Sticky Web Ground
    - Add boss:
        - Spawns eggs
        - Drains light and regains a bit of health for every 25% lost

Dungeon 1 Improvements:
    - Add rival fight when you open the door:
        - Rival guards the tomb
        - Rival is angered you have the Spirit Bow when you hit one of the switches.
        - If you are defeated, the elder may save you, otherwise it is game over.
    - Update wall laser graphics+behavior to actuall shoot lasers + be mounted on walls.
    - Update arrow turret graphics.

Dungeon 2 Improvements:
    - Add more uses of spirit sight:
        - See actual elemental beasts in the front room where the statues are located.
        - Some kind of optional spirit sight puzzle for a peach piece.

Dungeon 3 Improvements:
    - Add a required progress puzzle defeating enemies with rolling stones using spirit sight.
    - Make the guardian's projection use more interesting attacks.
    - Animate the ents when they attack.

Waterfall Tower Improvments:
    - Make bead flows act like shallow water for when you are walking in them?
        - This might not be the right animation for beads though.
    - Missing mechanics
        Rusty floor switch that only activates if you fall on it wearing iron boots.

River Temple Improvements:
    - Some underwater enemies
    - Some crab enemies with ice shells that require fire element to defeat
    - Maybe torches should stay lit during the boss fight once turned on.


Crater Improvements
    - Add platforms floating on lava.
    - Add peg switches that require hitting with the staff to activate, replace all regular switches with these.
    - Add Flame Guardian enemies
        - Stationary like Crystal Guardian
        - Replace ents with Flame Guardians
    - Lava Fireballs that spawn from lava in an anulus around player about ever 4 seconds
        - Rise into the air then explode into 8 fireballs.
    - Add Shepard's Maw enemy
        - Like a carnivorous plant in the spirit world
        - Projects fake enemies on tendrils into the material world to herd prey to its mouth
            - Fake enemies attack with projectiles or hot gas
        - Bites into the material world when the prey is near
        - Kill by evading the maw attack and then hitting it while it is briefly in material world
            - Or fight it in the spirit world if you are there
    - Add heat sink enemies
        - Like ghosts in material world
        - Become solid+vulnerable when they try to pump heat from the material world
        - Can turn lava tiles solid briefly, or solid tiles to ice
        - Will try to chase and freeze the player if they get near
            - Will lose interest in the player while frozen
        - 1 or 2 second cool down on freezing anything
    - Add Engorge Heat Sink mini boss
        - Giant heat sink that is cooling one of the under lava caves you uncover
        - 4x as large and slow, but shrinks and speeds up as damaged
        - About 2x faster than normal heats sinks at minimum size
        - On defeat it possesses the player giving them the "Cooling Spirit" ability (Fire Blessing).
        - The cave becomes hot again after the boss is defeated but they player is now immune to the effect.


Multi-area Boss ideas:
    - Plant-like boss that is growing in several chambers that you have to move between to defeat.
    - Boss that escapes and must be chased to different chambers.

Add Small Loot to editor that creates LootDrop
    - locked to tile grid
    - if on destructable tile (cuttable, pickup), not rendered/updated until the tile is destroyed.
        - This should actually be done for any loot, this will make it easy to hide keys under objects.
        - We can support progress items under tiles, but probably shouldn't actually use this in practice in order to avoid players searching under every tile. On the other hand, if we clearly telegraph when this happens, maybe we can void this problem and encourage players to use smart ways to check for things (like spirit sight to search under many objects for a key).
    - keep a hash of picked up objects in dungeons so these only replenish on leaving the dungeon.
    - Add an editor option to clear the history of picked up small loots.


Add ability to charge carried objects
    Hold the passive button when picking up an object to charge
    Charge level is limited both by level of gloves/bracers and charge level.
    Should add selected element to thrown object
    Apply element changes to tiles while you hold them (bush might burn up into ash in your hands with fire element, or turn to ice)


Improve Tool Selection:
    - Color around the selection + HUD indicator should match the color of the controller button (blue + yellow for X-Box)
    - Display a letter attached to the selection based on the button/keyboard key.

Additional Staff Behavior:
    Should damage enemies + knock them away
    Eventually Lvl 2 staff can be used to create the Staff Tower.
    - The sides of the staff should function as a wall rather than open ground.
    Charging the staff does a very large spin attack that knocks enemies away.
        Lvl 2 charge is a screen wide attack the applies damage+element to all enemies.
    Top N pixels of character should be drawn on foreground as well so that it appears in front of staff when facing north.
        - Probably should disable staff when character is standing on any tiles marked with low ceiling just in case.



Update collision detection and wiggle logic:
    - Create an array that is the width of the character(relative to movement direction) + 16
    - Assuming entry 8 = [ax, ay] and length - 9 = [ax + width - 1, ay] (for moving up or down) check pairs of 0 and 3 pixels every 4 pixels, so for w = 16, check 8+11,12+15,16+19,20+23. If any are blocked, movement is blocked, remember the blocked pixel index.
    - If movement is blocked if blocked index <= length / 2 then scan right starting at blocked index + 1. If w open pixels are found, wiggle right. If a blocked pixel is found at index >= length - w, then abort, wiggling is not possible.
    - If blocked index > length / 2, repeat the above except scanning left to check for left wiggle.

Some puzzle ideas:
    - A puzzle where 4 switches need to be hit in 200ms, you can blow up the clone in the middle to activate all at once.
    - If we place a block on top of a switch that toggles on release, we can make a door that requires you to push the block off of the switch.

Track the object an arrow is stuck in and move it with that target until it disappears
    - Use a different 'stuck' frame for the arrow missing the head.

Animate hearts refilling

Add spirit element that replaces the default 'none' element when the upgrade is found. In vanilla this would require getting all other elements first.

Idea:
    Objects you can bounce off of when jumping
        - Just make them solid and knock the player back a bit if the player's y velocity is >= some value?

Include some random dungeon design in the base game:
    - Location of key under object might change (there should be some clue where it is or use spirit sight).
    - Something like peg cave, but only a single peg needs to be pressed to open it (spirit sight reveals which?).
    - Something like Eastern Palace Foyer except the correct door isn't always the center door.

Keep in mind significance of design elements for future racing/randomizer.

Support 64x64 super tiles for world map. Or maybe just 48x48. Probably add this after Spirit World mechanics to make sure they perform okay together.

Possible tool: Leather gloves protect you from thorn bushes.
Possible tool: Leather boots let you walk on thorny ground without taking damage.

Paths to Elemental Beast Dungeons:

River Temple:
    (Implemented) Iron Boots(Waterfall Tower) -> Peach Cave -> Underwater Entrance
    Cloud Boots(Forest Temple) + Fire(Crater) -> Crater sky path to Temple roof opens after defeating Fire Elemental
    Cloud Boots(Forest Temple) + Lightning(Staff Tower) -> Tower B sky path connects to Temple roof


Staff Tower:
    Fire(Crater) -> Blow up pots in front of escalator using fire on explosive plants
    (Implemented) Clone(Forest Temple) -> Blow up pots in front of escalator with clone
    Ice(River Temple) -> Use ice magic to freeze the down escalator and walk up it.
    (Implemented) Cloud Boots(Forest Temple) -> Use cloud boots to walk up the down escalator
    Cloud Boots(Forest Temple) -> Sky path from Helix to Tower Balcony

Crater:
    (Implemented) Cloud Boots(Forest Temple) -> Sky path from Helix to Crater Peak
    Cloud Boots(Forest Temple) + Tower Staff(Staff Tower) + Ice(River Temple) =>  Tower B Sky path connects to Crater Peak
    Ice(River Temple) -> Use Ice to pass lava in cave to Crater Peak


Dungeon flavor philosophy:
    All Vanara structures are part of the Vanara ship and related to some functionality, such as the regeneration pods.
    All Native structures are built to native spirit gods who functioned as servants to the old native spirit beings and were created for specific purposes like resource harvesting, processing and crafting.


Ability Locations:
# Prologue
    weapon 1            Peach Cave Chest
    catEyes             Peach Cave Boss
# Starting Dungeons
    bow                 Vanara Village
    roll                Vanara Tomb Chest
    spiritSight         Vanara Tomb Boss
    gloves              Summoner Ruins Chest
    astralProjection    Summoner Ruins Boss
    spiritCloak         Cocoon Chest
    teleportation       Cocoon Boss
# Treasure Dungeons
    cloudBoots          Forest Temple Chest
    clone               Forest Temple Boss
    ironBoots           Waterfall Tower Chest
    spiritCloak 2       Waterfall Tower Boss
    gloves 2            Forge Chest
    goldMail            Forge Boss
    roll 2              Cloud Temple Chest
    nimbusCloud         Cloud Temple Boss
    bow 2               Grand Temple Chest
    ironSkin            Grand Temple Boss
    trueSight           Jade Palace Chest
    phoenixCrown        Jade Palace Boss
# First Quest Dungeon
    staff               Helix Chest
    charge              Helix Boss
# Middle Quest Dungeons
    fireBlessing        Crater Big Chest
    fire                Crater Boss Flame Beast
    waterBlessing       River Temple Big Chest
    ice                 River Temple Boss Frost Beast
    lightning           Staff Tower Boss Storm Beast
    staff 2             Staff Tower "Chest" (after boss)
    weapon 2            Acquired with first Element
    charge 2            Acquired with second Element
# Final Quest Dungeon
    clone 2             Warship Chest

Ability order:

Early Dungeons:
    Peach Cave: Completing the cave awakens MCs spirit abilities giving them their spirit bar + cat eyes.
(Head home, mother indicates you should head to Vanara Village to speak with the elder.)
(Vanara Village: Get the bow from the elder.)
    Vanara Tomb: Dodge Roll in big chest, Spirit Sight from the Vanara Guardian.
(mother indicates you should head to Summoner Ruins.)
    Summoner Ruins: Bracers in big chest, Astral Projection after defeating the boss.
    Cocoon: spiritCloak in big chest, Teleportation from Vanara Guardian.
    Helix: Tree Staff in big chest, charge from Vanara Captain.

Elemental Beasts: (triggered by Helix or entering the Spirit World)
    River Temple(Old Fertility Temple: Water Blessing Big Chest, Frost Beast(ice element)
    Mountain Crater: Fire Blessing Big Chest, Flame Beast(fire element)
    Staff Tower: Storm Beast(lightning element) + Tower Staff in Big Chest after boss

Late Dungeons:
    Forest Temple(New Fertility Temple): Cloud Boots in chest, Clone after boss
    Waterfall Tower: Iron Boots in chest, spiritCloak 2 after boss
    The Forge: Gloves 2 in chest, gold mail after boss
    Grand Temple: Bow 2 chest, iron Skin after boss
    Jade Palace: True Sight in chest, Phoenix Crown after boss
    Cloud Temple: Roll 2 in chest, Nimbus Cloud after boss.

Final Dungeon:
    Warship: Clone 2 in big chest

Dungeon 1: Vanara Tomb (fortress around the Cocoon)
    - Traps+locks to keep intruders away. Need to use bow to enter
        - Someone was stealing Vanara remains
    - Built around a suspended animation capsule
        - The Vanara population is too large so they rotate members in and out of suspended animation.
        - Suspension pods erase Vanara memories to prevent then from becoming restless.
        - Pods also regenerate Vanara bodies, which would break down without nurishment from the spirit world.
        - Vanara village population is 20-30 individuals at a time. There are 100-300 total, most suspended.
    - The goal of the dungeon is to meet with the care taker who looks after and maintains the suspended Vanara.
        - The original Vanara crew rotate members into the care taker role once every X years.
    - A facade is built aroaund the structure to disguise it as a mundane structure
        - The Vanara village posts guards in addition to the traps to keep people out
    - MCs father refused to go back to sleep, having fallen in love with MCs mother and not wanting to forget about her.


Dungeon 2: Ruins of Summoner village and Temple of War
    - Expected loadout: Cat Eyes, 6 hearts, Dodge, Bow, Spirit Sight
    - Enemies: Flame/Frost/Storm mobs
    - Big Chest: Gloves 1
    - Boss: Elemental idols
    - Boss Reward: Astral Projection

Dungeon 3: Cocoon (Vanara Regeneration Unit)
    - Expected loadout: Cat Eyes, 7 hearts, Dodge, Bow, Spirit Sight, Gloves, Astral Projection
    - Enemies
    - Big Chest: Invisibility Technique
    - Boss:
    - Boss Reward: Teleportation (body moves to astral projection when pressing either tool button)


River Temple:
    - No NPCs here, this was the old Fertility Temple, but it was destroyed by the Varuna Ship crashing. The survivors all moved to the new Fertility Temple near the forest (Forest Temple).
